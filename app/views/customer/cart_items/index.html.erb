<% provide(:title, "カート") %>

<div class="clearfix">
	<h1 class="pull-left">ショッピングカート</h1>
	<% if @cart_items.present? %>
		<%= link_to "カートを空にする", cart_items_path, method: :delete, data: { confirm: '本当に消しますか？' }, class:"btn btn-danger pull-right" %>
	<% end %>
</div>
<table class="table">
	<thead>
		<tr class="active">
			<th>商品名</th>
			<th>単価（税込）</th>
			<th>数量</th>
			<th>小計</th>
			<th></th>
		</tr>
	</thead>
	<tbody>
		<% @cart_items.each do |cart_item| %>
			<tr>
				<td>
					<%= link_to items_path(cart_item.item) do %>
				 		<%= attachment_image_tag(cart_item.item, :image,　format: 'jpeg', size: "80x80") %>
					<% end %>
					<%= cart_item.item.name %>
				</td>
				<td><%= tax_price(cart_item.item.price) %>円</td>
				<td>
					<%= form_for cart_item, url:cart_item_path(cart_item.id) do |f| %>
					  <%= f.number_field :amount, size: 10, min: 1 %>
					  <%= f.submit "変更", class:"btn btn-primary"%>
					<% end %>
				</td>
				<td><%= sub_total(cart_item) %>円</td>
				<td><%= link_to "削除する", cart_item_path(cart_item), method: :delete, class:"btn btn-danger pull-right" %></td>
			</tr>
		<% end %>
	</tbody>
</table>
<div class="clearfix">
	<div class="pull-left">
		<%= link_to "買い物を続ける", items_path, class:"btn btn-primary" %>
	</div>
	<div class="pull-right">
		<table class="table">
			<tbody>
				<tr>
					<td class="active">合計金額</td>
					<td><%= total_price(@cart_items) %>円</td>
				</tr>
			</tbody>
		</table>
	</div>
</div>
<div>
	<% if @cart_items.present? %>
		<%= link_to "注文に進む", new_order_path, class:"btn btn-success" %>
	<% end %>
</div>